<!DOCTYPE html>
<html>
<head>
    <title>Hospital Transfer System</title>
</head>
<body>

<h2>Patient Transfer System</h2>

<label>Date:</label>
<input type="date" id="date"><br><br>

<label>From Ward:</label>
<select id="fromWard">
    <option>Medical Ward</option>
    <option>Surgical Ward</option>
    <option>ICU</option>
    <option>ETU</option>
</select><br><br>

<label>To Ward:</label>
<select id="toWard">
    <option>Medical Ward</option>
    <option>Surgical Ward</option>
    <option>ICU</option>
    <option>ETU</option>
</select><br><br>

<label>Patient Count:</label>
<input type="number" id="count"><br><br>

<button onclick="saveData()">Save</button>

<h3>Transfer History</h3>
<table border="1">
    <thead>
        <tr>
            <th>Date</th>
            <th>From</th>
            <th>To</th>
            <th>Count</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
const token = "YOUR_GITHUB_TOKEN";
const repo = "YOUR_USERNAME/YOUR_REPO";
const filePath = "transfers.json";

async function saveData() {
    const date = document.getElementById("date").value;
    const fromWard = document.getElementById("fromWard").value;
    const toWard = document.getElementById("toWard").value;
    const count = document.getElementById("count").value;

    const newData = {
        date: date,
        fromWard: fromWard,
        toWard: toWard,
        count: count
    };

    let existingData = [];

    const response = await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
        headers: {
            Authorization: `token ${token}`
        }
    });

    const fileData = await response.json();
    const content = atob(fileData.content);
    existingData = JSON.parse(content);

    existingData.push(newData);

    const updatedContent = btoa(JSON.stringify(existingData, null, 2));

    await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
        method: "PUT",
        headers: {
            Authorization: `token ${token}`,
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            message: "Update transfers",
            content: updatedContent,
            sha: fileData.sha
        })
    });

    alert("Saved Successfully!");
}
</script>

</body>
</html>
